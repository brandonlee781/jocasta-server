# Migration `watch-20200111171257`

This migration has been generated by Brandon Lee at 1/11/2020, 5:13:02 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
CREATE TABLE "jocasta_schema"."Threshold" (
  "current" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "threshold" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."DefenseAttribute" (
  "id" text  NOT NULL  ,
  "melee" integer  NOT NULL DEFAULT 0 ,
  "ranged" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Duty" (
  "current" integer  NOT NULL DEFAULT 0 ,
  "description" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "model" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Experience" (
  "available" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "total" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Characteristic" (
  "agility" integer  NOT NULL DEFAULT 0 ,
  "brawn" integer  NOT NULL DEFAULT 0 ,
  "cunning" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "intellect" integer  NOT NULL DEFAULT 0 ,
  "presence" integer  NOT NULL DEFAULT 0 ,
  "willpower" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."DerivedAttributes" (
  "id" text  NOT NULL  ,
  "soak" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

ALTER TABLE "jocasta_schema"."User" DROP COLUMN "name",
ADD COLUMN "name" text    ;

ALTER TABLE "jocasta_schema"."DerivedAttributes" ADD COLUMN "defense" text  NOT NULL  REFERENCES "jocasta_schema"."DefenseAttribute"("id") ON DELETE RESTRICT,
ADD COLUMN "strain" text  NOT NULL  REFERENCES "jocasta_schema"."Threshold"("id") ON DELETE RESTRICT,
ADD COLUMN "wounds" text  NOT NULL  REFERENCES "jocasta_schema"."Threshold"("id") ON DELETE RESTRICT;

DROP TABLE "jocasta_schema"."Post";

CREATE UNIQUE INDEX "DerivedAttributes_wounds" ON "jocasta_schema"."DerivedAttributes"("wounds")

CREATE UNIQUE INDEX "DerivedAttributes_strain" ON "jocasta_schema"."DerivedAttributes"("strain")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration watch-20200111164905..watch-20200111171257
--- datamodel.dml
+++ datamodel.dml
@@ -3,24 +3,81 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://brandonlee:Srf32pstgrs@localhost:5432/jocasta?schema=jocasta_schema"
 }
-model Post {
-  id        String   @default(cuid()) @id
-  createdAt DateTime @default(now())
-  updatedAt DateTime @updatedAt
-  published Boolean  @default(false)
-  title     String
-  content   String?
-  author    User?
-}
-
 model User {
   id       String  @default(cuid()) @id
   email    String  @unique
   password String
   name     String?
-  posts    Post[]
+}
+
+enum System {
+  AOR
+  EOTE
+  FAD
+}
+
+enum Range {
+  Engaged
+  Short
+  Medium
+  Long
+  Extreme
+}
+
+enum CharacteristicName {
+  Brawn
+  Agility
+  Intellect
+  Cunning
+  Willpower
+  Presence
+}
+
+model Threshold {
+  id              String @default(cuid()) @id
+  threshold       Int
+  current         Int
+  woundsThreshold DerivedAttributes? @relation("WoundsThreshold")
+  strainThreshold DerivedAttributes? @relation("StrainThreshold")
+}
+
+model DefenseAttribute {
+  id      String  @default(cuid()) @id
+  ranged  Int     @default(0)
+  melee   Int     @default(0)
+}
+
+model Duty {
+  id            String  @default(cuid()) @id
+  model         String
+  description   String
+  current       Int     @default(0)
+}
+
+model Experience {
+  id          String @default(cuid()) @id
+  total       Int
+  available   Int
+}
+
+model Characteristic {
+  id        String  @default(cuid()) @id
+  brawn     Int     @default(0)
+  agility   Int     @default(0)
+  intellect Int     @default(0)
+  cunning   Int     @default(0)
+  willpower Int     @default(0)
+  presence  Int     @default(0)
+}
+
+model DerivedAttributes {
+  id      String    @default(cuid()) @id
+  soak    Int
+  wounds  Threshold @relation("WoundsThreshold")
+  strain  Threshold @relation("StrainThreshold")
+  defense DefenseAttribute
 }
```


