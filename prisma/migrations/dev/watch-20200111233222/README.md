# Migration `watch-20200111233222`

This migration has been generated by Brandon Lee at 1/11/2020, 11:32:23 PM.
You can check out the [state of the schema](./schema.prisma) after the migration.

## Database Steps

```sql
DROP TABLE "jocasta_schema"."Armor","jocasta_schema"."Attachment","jocasta_schema"."Career","jocasta_schema"."Character","jocasta_schema"."CharacterSkill","jocasta_schema"."CharacterTalent","jocasta_schema"."Characteristic","jocasta_schema"."DefenseAttribute","jocasta_schema"."DerivedAttributes","jocasta_schema"."Duty","jocasta_schema"."Experience","jocasta_schema"."Gear","jocasta_schema"."Skill","jocasta_schema"."Specialization","jocasta_schema"."Talent","jocasta_schema"."TalentTree","jocasta_schema"."TalentTreeLocation","jocasta_schema"."Threshold","jocasta_schema"."User","jocasta_schema"."Weapon";

CREATE TABLE "jocasta_schema"."Career" (
  "id" integer  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Threshold" (
  "current" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "threshold" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."DefenseAttribute" (
  "id" text  NOT NULL  ,
  "melee" integer  NOT NULL DEFAULT 0 ,
  "ranged" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Duty" (
  "current" integer  NOT NULL DEFAULT 0 ,
  "description" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "model" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Experience" (
  "available" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "total" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Characteristic" (
  "agility" integer  NOT NULL DEFAULT 0 ,
  "brawn" integer  NOT NULL DEFAULT 0 ,
  "cunning" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "intellect" integer  NOT NULL DEFAULT 0 ,
  "presence" integer  NOT NULL DEFAULT 0 ,
  "willpower" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."DerivedAttributes" (
  "id" text  NOT NULL  ,
  "soak" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Character" (
  "background" text    ,
  "createdAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  "credits" integer    ,
  "description" text    ,
  "id" text  NOT NULL  ,
  "imageUrl" text    ,
  "injuries" text    ,
  "motivation" text    ,
  "name" text  NOT NULL DEFAULT '' ,
  "notes" text    ,
  "resources" text    ,
  "species" text  NOT NULL DEFAULT '' ,
  "system" text  NOT NULL DEFAULT 'AOR' ,
  "updatedAt" timestamp(3)  NOT NULL DEFAULT '1970-01-01 00:00:00' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Gear" (
  "description" text    ,
  "encumberance" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "quantity" integer  NOT NULL DEFAULT 1 ,
  "rarity" integer  NOT NULL DEFAULT 1 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Attachment" (
  "base" text  NOT NULL DEFAULT '' ,
  "hardPoints" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "modifications" text  NOT NULL DEFAULT '' ,
  "name" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Weapon" (
  "condition" text    ,
  "critical" integer  NOT NULL DEFAULT 0 ,
  "damage" integer  NOT NULL DEFAULT 0 ,
  "description" text    ,
  "encumberance" integer  NOT NULL DEFAULT 0 ,
  "hardPoints" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "make" text    ,
  "name" text  NOT NULL DEFAULT '' ,
  "quantity" integer  NOT NULL DEFAULT 1 ,
  "range" text  NOT NULL DEFAULT 'Engaged' ,
  "rarity" integer  NOT NULL DEFAULT 1 ,
  "skill" text  NOT NULL DEFAULT 'Brawl' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Armor" (
  "condition" text    ,
  "description" text    ,
  "encumberance" integer  NOT NULL DEFAULT 0 ,
  "hardPoints" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "quantity" integer  NOT NULL DEFAULT 1 ,
  "rarity" integer  NOT NULL DEFAULT 1 ,
  "soak" integer  NOT NULL DEFAULT 0 ,
  "wearing" boolean  NOT NULL DEFAULT false ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Skill" (
  "characteristic" text  NOT NULL DEFAULT 'Brawn' ,
  "id" integer  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "type" text  NOT NULL DEFAULT 'General' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."CharacterSkill" (
  "career" boolean  NOT NULL DEFAULT true ,
  "id" text  NOT NULL  ,
  "rank" integer  NOT NULL DEFAULT 0 ,
  "skillId" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Specialization" (
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."TalentTreeLocation" (
  "column" integer  NOT NULL DEFAULT 0 ,
  "connections" integer []   ,
  "id" text  NOT NULL  ,
  "purchased" boolean  NOT NULL DEFAULT false ,
  "row" integer  NOT NULL DEFAULT 0 ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."TalentTree" (
  "id" text  NOT NULL  ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."CharacterTalent" (
  "column" integer  NOT NULL DEFAULT 0 ,
  "id" text  NOT NULL  ,
  "row" integer  NOT NULL DEFAULT 0 ,
  "talentId" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."Talent" (
  "activation" text  NOT NULL DEFAULT 'Passive' ,
  "description" text    ,
  "force" boolean  NOT NULL DEFAULT false ,
  "id" text  NOT NULL  ,
  "name" text  NOT NULL DEFAULT '' ,
  "page" text    ,
  "ranked" boolean  NOT NULL DEFAULT false ,
  PRIMARY KEY ("id")
);

CREATE TABLE "jocasta_schema"."User" (
  "email" text  NOT NULL DEFAULT '' ,
  "id" text  NOT NULL  ,
  "name" text    ,
  "password" text  NOT NULL DEFAULT '' ,
  PRIMARY KEY ("id")
);

ALTER TABLE "jocasta_schema"."Duty" ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."DerivedAttributes" ADD COLUMN "defense" text  NOT NULL  REFERENCES "jocasta_schema"."DefenseAttribute"("id") ON DELETE RESTRICT,
ADD COLUMN "strain" text  NOT NULL  REFERENCES "jocasta_schema"."Threshold"("id") ON DELETE RESTRICT,
ADD COLUMN "wounds" text  NOT NULL  REFERENCES "jocasta_schema"."Threshold"("id") ON DELETE RESTRICT;

ALTER TABLE "jocasta_schema"."Character" ADD COLUMN "characteristics" text  NOT NULL  REFERENCES "jocasta_schema"."Characteristic"("id") ON DELETE RESTRICT,
ADD COLUMN "derivedAttributes" text    REFERENCES "jocasta_schema"."DerivedAttributes"("id") ON DELETE SET NULL,
ADD COLUMN "encumberance" text    REFERENCES "jocasta_schema"."Threshold"("id") ON DELETE SET NULL,
ADD COLUMN "experience" text    REFERENCES "jocasta_schema"."Experience"("id") ON DELETE SET NULL,
ADD COLUMN "user" text  NOT NULL  REFERENCES "jocasta_schema"."User"("id") ON DELETE RESTRICT;

ALTER TABLE "jocasta_schema"."Gear" ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."Attachment" ADD COLUMN "armor" text    REFERENCES "jocasta_schema"."Armor"("id") ON DELETE SET NULL,
ADD COLUMN "weapon" text    REFERENCES "jocasta_schema"."Weapon"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."Weapon" ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."Armor" ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL,
ADD COLUMN "defense" text    REFERENCES "jocasta_schema"."DefenseAttribute"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."Skill" ADD COLUMN "career" integer    REFERENCES "jocasta_schema"."Career"("id") ON DELETE SET NULL,
ADD COLUMN "specialization" text    REFERENCES "jocasta_schema"."Specialization"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."CharacterSkill" ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."Specialization" ADD COLUMN "career" integer  NOT NULL  REFERENCES "jocasta_schema"."Career"("id") ON DELETE RESTRICT,
ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."TalentTreeLocation" ADD COLUMN "talentTree" text    REFERENCES "jocasta_schema"."TalentTree"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."TalentTree" ADD COLUMN "specialization" text  NOT NULL  REFERENCES "jocasta_schema"."Specialization"("id") ON DELETE RESTRICT,
ADD COLUMN "talent" text    REFERENCES "jocasta_schema"."Talent"("id") ON DELETE SET NULL;

ALTER TABLE "jocasta_schema"."CharacterTalent" ADD COLUMN "character" text    REFERENCES "jocasta_schema"."Character"("id") ON DELETE SET NULL,
ADD COLUMN "specialization" text  NOT NULL  REFERENCES "jocasta_schema"."Specialization"("id") ON DELETE RESTRICT;

ALTER TABLE "jocasta_schema"."Talent" ADD COLUMN "specialization" text    REFERENCES "jocasta_schema"."Specialization"("id") ON DELETE SET NULL;

CREATE UNIQUE INDEX "DerivedAttributes_wounds" ON "jocasta_schema"."DerivedAttributes"("wounds")

CREATE UNIQUE INDEX "DerivedAttributes_strain" ON "jocasta_schema"."DerivedAttributes"("strain")

CREATE  INDEX "Character.id_name" ON "jocasta_schema"."Character"("id","name")

CREATE UNIQUE INDEX "Character_derivedAttributes" ON "jocasta_schema"."Character"("derivedAttributes")

CREATE UNIQUE INDEX "Skill.name" ON "jocasta_schema"."Skill"("name")

CREATE UNIQUE INDEX "User.email" ON "jocasta_schema"."User"("email")

CREATE  INDEX "User.email_name" ON "jocasta_schema"."User"("email","name")
```

## Changes

```diff
diff --git schema.prisma schema.prisma
migration watch-20200111232202..watch-20200111233222
--- datamodel.dml
+++ datamodel.dml
@@ -3,9 +3,9 @@
 }
 datasource db {
   provider = "postgresql"
-  url = "***"
+  url      = "postgresql://brandonlee:Srf32pstgrs@localhost:5432/jocasta?schema=jocasta_schema"
 }
 enum GearCondition {
   NONE
@@ -68,9 +68,9 @@
 }
 // Career
 model Career {
-  id                String            @default(cuid()) @id
+  id                Int               @id
   name              String
   skills            Skill[]
   specializations   Specialization[]
 }
```


